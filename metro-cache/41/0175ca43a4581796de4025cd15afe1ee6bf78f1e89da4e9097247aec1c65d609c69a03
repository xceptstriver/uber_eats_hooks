{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"locs":[{"start":{"line":19,"column":0},"end":{"line":19,"column":58}}]}},{"name":"../vendor/emitter/EventEmitter","data":{"asyncType":null,"locs":[{"start":{"line":19,"column":0},"end":{"line":19,"column":58}}]}},{"name":"../Utilities/infoLog","data":{"asyncType":null,"locs":[{"start":{"line":132,"column":13},"end":{"line":132,"column":69}},{"start":{"line":143,"column":13},"end":{"line":143,"column":68}}]}},{"name":"invariant","data":{"asyncType":null,"locs":[{"start":{"line":144,"column":4},"end":{"line":144,"column":78}}]}},{"name":"./TaskQueue","data":{"asyncType":null,"locs":[{"start":{"line":165,"column":19},"end":{"line":165,"column":64}}]}},{"name":"../BatchedBridge/BatchedBridge","data":{"asyncType":null,"locs":[{"start":{"line":211,"column":8},"end":{"line":211,"column":45}}]}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  var _EventEmitter = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\")(_$$_REQUIRE(_dependencyMap[1], \"../vendor/emitter/EventEmitter\"));\n\n  var _emitter = new _EventEmitter.default();\n\n  var DEBUG_DELAY = 0;\n  var DEBUG = false;\n  var InteractionManager = {\n    Events: {\n      interactionStart: 'interactionStart',\n      interactionComplete: 'interactionComplete'\n    },\n    runAfterInteractions: function runAfterInteractions(task) {\n      var tasks = [];\n      var promise = new Promise(function (resolve) {\n        _scheduleUpdate();\n\n        if (task) {\n          tasks.push(task);\n        }\n\n        tasks.push({\n          run: resolve,\n          name: 'resolve ' + (task && task.name || '?')\n        });\n\n        _taskQueue.enqueueTasks(tasks);\n      });\n      return {\n        then: promise.then.bind(promise),\n        done: function done() {\n          if (promise.done) {\n            return promise.done.apply(promise, arguments);\n          } else {\n            console.warn('Tried to call done when not supported by current Promise implementation.');\n          }\n        },\n        cancel: function cancel() {\n          _taskQueue.cancelTasks(tasks);\n        }\n      };\n    },\n    createInteractionHandle: function createInteractionHandle() {\n      DEBUG && _$$_REQUIRE(_dependencyMap[2], \"../Utilities/infoLog\")('InteractionManager: create interaction handle');\n\n      _scheduleUpdate();\n\n      var handle = ++_inc;\n\n      _addInteractionSet.add(handle);\n\n      return handle;\n    },\n    clearInteractionHandle: function clearInteractionHandle(handle) {\n      DEBUG && _$$_REQUIRE(_dependencyMap[2], \"../Utilities/infoLog\")('InteractionManager: clear interaction handle');\n\n      _$$_REQUIRE(_dependencyMap[3], \"invariant\")(!!handle, 'InteractionManager: Must provide a handle to clear.');\n\n      _scheduleUpdate();\n\n      _addInteractionSet.delete(handle);\n\n      _deleteInteractionSet.add(handle);\n    },\n    addListener: _emitter.addListener.bind(_emitter),\n    setDeadline: function setDeadline(deadline) {\n      _deadline = deadline;\n    }\n  };\n\n  var _interactionSet = new Set();\n\n  var _addInteractionSet = new Set();\n\n  var _deleteInteractionSet = new Set();\n\n  var _taskQueue = new (_$$_REQUIRE(_dependencyMap[4], \"./TaskQueue\"))({\n    onMoreTasks: _scheduleUpdate\n  });\n\n  var _nextUpdateHandle = 0;\n  var _inc = 0;\n\n  var _deadline = -1;\n\n  function _scheduleUpdate() {\n    if (!_nextUpdateHandle) {\n      if (_deadline > 0) {\n        _nextUpdateHandle = setTimeout(_processUpdate, 0 + DEBUG_DELAY);\n      } else {\n        _nextUpdateHandle = setImmediate(_processUpdate);\n      }\n    }\n  }\n\n  function _processUpdate() {\n    _nextUpdateHandle = 0;\n    var interactionCount = _interactionSet.size;\n\n    _addInteractionSet.forEach(function (handle) {\n      return _interactionSet.add(handle);\n    });\n\n    _deleteInteractionSet.forEach(function (handle) {\n      return _interactionSet.delete(handle);\n    });\n\n    var nextInteractionCount = _interactionSet.size;\n\n    if (interactionCount !== 0 && nextInteractionCount === 0) {\n      _emitter.emit(InteractionManager.Events.interactionComplete);\n    } else if (interactionCount === 0 && nextInteractionCount !== 0) {\n      _emitter.emit(InteractionManager.Events.interactionStart);\n    }\n\n    if (nextInteractionCount === 0) {\n      while (_taskQueue.hasTasksToProcess()) {\n        _taskQueue.processNext();\n\n        if (_deadline > 0 && _$$_REQUIRE(_dependencyMap[5], \"../BatchedBridge/BatchedBridge\").getEventLoopRunningTime() >= _deadline) {\n          _scheduleUpdate();\n\n          break;\n        }\n      }\n    }\n\n    _addInteractionSet.clear();\n\n    _deleteInteractionSet.clear();\n  }\n\n  module.exports = InteractionManager;\n});","lineCount":136,"map":[[2,0,11,0],[4,0,19,0],[6,0,24,0],[6,6,24,6,"_emitter"],[6,14,24,14],[6,17,24,17],[6,21,24,21,"EventEmitter"],[6,42,24,17],[6,44,24,0],[8,0,26,0],[8,6,26,6,"DEBUG_DELAY"],[8,17,26,20],[8,20,26,23],[8,21,26,0],[9,0,27,0],[9,6,27,6,"DEBUG"],[9,11,27,18],[9,14,27,21],[9,19,27,0],[10,0,78,0],[10,6,78,6,"InteractionManager"],[10,24,78,24],[10,27,78,27],[11,0,79,2,"Events"],[11,4,79,2,"Events"],[11,10,79,8],[11,12,79,10],[12,0,80,4,"interactionStart"],[12,6,80,4,"interactionStart"],[12,22,80,20],[12,24,80,22],[12,42,79,10],[13,0,81,4,"interactionComplete"],[13,6,81,4,"interactionComplete"],[13,25,81,23],[13,27,81,25],[14,0,79,10],[14,5,78,27],[15,0,88,2,"runAfterInteractions"],[15,4,88,2,"runAfterInteractions"],[15,24,78,27],[15,56,89,4,"task"],[15,60,78,27],[15,62,98,4],[16,0,99,4],[16,10,99,10,"tasks"],[16,15,99,28],[16,18,99,31],[16,20,99,4],[17,0,100,4],[17,10,100,10,"promise"],[17,17,100,17],[17,20,100,20],[17,24,100,24,"Promise"],[17,31,100,20],[17,32,100,32],[17,42,100,33,"resolve"],[17,49,100,32],[17,51,100,57],[18,0,101,6,"_scheduleUpdate"],[18,8,101,6,"_scheduleUpdate"],[18,23,101,21],[20,0,102,6],[20,12,102,10,"task"],[20,16,102,6],[20,18,102,16],[21,0,103,8,"tasks"],[21,10,103,8,"tasks"],[21,15,103,13],[21,16,103,14,"push"],[21,20,103,8],[21,21,103,19,"task"],[21,25,103,8],[22,0,104,7],[24,0,105,6,"tasks"],[24,8,105,6,"tasks"],[24,13,105,11],[24,14,105,12,"push"],[24,18,105,6],[24,19,105,17],[25,0,106,8,"run"],[25,10,106,8,"run"],[25,13,106,11],[25,15,106,13,"resolve"],[25,22,105,17],[26,0,107,8,"name"],[26,10,107,8,"name"],[26,14,107,12],[26,16,107,14],[26,30,107,29,"task"],[26,34,107,33],[26,38,107,37,"task"],[26,42,107,41],[26,43,107,42,"name"],[26,47,107,28],[26,51,107,51],[26,54,107,14],[27,0,105,17],[27,9,105,6],[29,0,109,6,"_taskQueue"],[29,8,109,6,"_taskQueue"],[29,18,109,16],[29,19,109,17,"enqueueTasks"],[29,31,109,6],[29,32,109,30,"tasks"],[29,37,109,6],[30,0,110,5],[30,7,100,20],[30,8,100,4],[31,0,111,4],[31,13,111,11],[32,0,112,6,"then"],[32,8,112,6,"then"],[32,12,112,10],[32,14,112,12,"promise"],[32,21,112,19],[32,22,112,20,"then"],[32,26,112,12],[32,27,112,25,"bind"],[32,31,112,12],[32,32,112,30,"promise"],[32,39,112,12],[32,40,111,11],[33,0,113,6,"done"],[33,8,113,6,"done"],[33,12,113,10],[33,14,113,12],[33,30,113,25],[34,0,114,8],[34,14,114,12,"promise"],[34,21,114,19],[34,22,114,20,"done"],[34,26,114,8],[34,28,114,26],[35,0,115,10],[35,19,115,17,"promise"],[35,26,115,24],[35,27,115,25,"done"],[35,31,115,17],[35,38,115,17,"promise"],[35,45,115,24],[35,57,115,10],[36,0,116,9],[36,11,114,8],[36,17,116,15],[37,0,117,10,"console"],[37,12,117,10,"console"],[37,19,117,17],[37,20,117,18,"warn"],[37,24,117,10],[37,25,118,12],[37,99,117,10],[38,0,120,9],[39,0,121,7],[39,9,111,11],[40,0,122,6,"cancel"],[40,8,122,6,"cancel"],[40,14,122,12],[40,16,122,14],[40,34,122,25],[41,0,123,8,"_taskQueue"],[41,10,123,8,"_taskQueue"],[41,20,123,18],[41,21,123,19,"cancelTasks"],[41,32,123,8],[41,33,123,31,"tasks"],[41,38,123,8],[42,0,124,7],[43,0,111,11],[43,7,111,4],[44,0,126,3],[44,5,78,27],[45,0,131,2,"createInteractionHandle"],[45,4,131,2,"createInteractionHandle"],[45,27,78,27],[45,64,131,36],[46,0,132,4,"DEBUG"],[46,6,132,4,"DEBUG"],[46,11,132,9],[46,15,132,13],[46,70,132,21],[46,117,132,13],[46,118,132,4],[48,0,133,4,"_scheduleUpdate"],[48,6,133,4,"_scheduleUpdate"],[48,21,133,19],[50,0,134,4],[50,10,134,10,"handle"],[50,16,134,16],[50,19,134,19],[50,21,134,21,"_inc"],[50,25,134,4],[52,0,135,4,"_addInteractionSet"],[52,6,135,4,"_addInteractionSet"],[52,24,135,22],[52,25,135,23,"add"],[52,28,135,4],[52,29,135,27,"handle"],[52,35,135,4],[54,0,136,4],[54,13,136,11,"handle"],[54,19,136,4],[55,0,137,3],[55,5,78,27],[56,0,142,2,"clearInteractionHandle"],[56,4,142,2,"clearInteractionHandle"],[56,26,78,27],[56,60,142,25,"handle"],[56,66,78,27],[56,68,142,41],[57,0,143,4,"DEBUG"],[57,6,143,4,"DEBUG"],[57,11,143,9],[57,15,143,13],[57,70,143,21],[57,116,143,13],[57,117,143,4],[59,0,144,4],[59,50,144,14],[59,51,144,15],[59,52,144,16,"handle"],[59,58,144,4],[59,60,144,24],[59,113,144,4],[61,0,145,4,"_scheduleUpdate"],[61,6,145,4,"_scheduleUpdate"],[61,21,145,19],[63,0,146,4,"_addInteractionSet"],[63,6,146,4,"_addInteractionSet"],[63,24,146,22],[63,25,146,23,"delete"],[63,31,146,4],[63,32,146,30,"handle"],[63,38,146,4],[65,0,147,4,"_deleteInteractionSet"],[65,6,147,4,"_deleteInteractionSet"],[65,27,147,25],[65,28,147,26,"add"],[65,31,147,4],[65,32,147,30,"handle"],[65,38,147,4],[66,0,148,3],[66,5,78,27],[67,0,150,2,"addListener"],[67,4,150,2,"addListener"],[67,15,150,13],[67,17,150,16,"_emitter"],[67,25,150,24],[67,26,150,25,"addListener"],[67,37,150,16],[67,38,150,37,"bind"],[67,42,150,16],[67,43,150,42,"_emitter"],[67,51,150,16],[67,52,78,27],[68,0,157,2,"setDeadline"],[68,4,157,2,"setDeadline"],[68,15,78,27],[68,38,157,14,"deadline"],[68,46,78,27],[68,48,157,32],[69,0,158,4,"_deadline"],[69,6,158,4,"_deadline"],[69,15,158,13],[69,18,158,16,"deadline"],[69,26,158,4],[70,0,159,3],[71,0,78,27],[71,3,78,0],[73,0,162,0],[73,6,162,6,"_interactionSet"],[73,21,162,21],[73,24,162,24],[73,28,162,28,"Set"],[73,31,162,24],[73,33,162,0],[75,0,163,0],[75,6,163,6,"_addInteractionSet"],[75,24,163,24],[75,27,163,27],[75,31,163,31,"Set"],[75,34,163,27],[75,36,163,0],[77,0,164,0],[77,6,164,6,"_deleteInteractionSet"],[77,27,164,27],[77,30,164,30],[77,34,164,34,"Set"],[77,37,164,30],[77,39,164,0],[79,0,165,0],[79,6,165,6,"_taskQueue"],[79,16,165,16],[79,19,165,19],[79,71,165,33],[80,0,165,34,"onMoreTasks"],[80,4,165,34,"onMoreTasks"],[80,15,165,45],[80,17,165,47,"_scheduleUpdate"],[81,0,165,33],[81,3,165,19],[81,4,165,0],[83,0,166,0],[83,6,166,4,"_nextUpdateHandle"],[83,23,166,21],[83,26,166,24],[83,27,166,0],[84,0,167,0],[84,6,167,4,"_inc"],[84,10,167,8],[84,13,167,11],[84,14,167,0],[86,0,168,0],[86,6,168,4,"_deadline"],[86,15,168,13],[86,18,168,16],[86,19,168,17],[86,20,168,0],[88,0,173,0],[88,11,173,9,"_scheduleUpdate"],[88,26,173,0],[88,29,173,27],[89,0,174,2],[89,8,174,6],[89,9,174,7,"_nextUpdateHandle"],[89,26,174,2],[89,28,174,26],[90,0,175,4],[90,10,175,8,"_deadline"],[90,19,175,17],[90,22,175,20],[90,23,175,4],[90,25,175,23],[91,0,179,6,"_nextUpdateHandle"],[91,8,179,6,"_nextUpdateHandle"],[91,25,179,23],[91,28,179,26,"setTimeout"],[91,38,179,36],[91,39,179,37,"_processUpdate"],[91,53,179,36],[91,55,179,53],[91,59,179,57,"DEBUG_DELAY"],[91,70,179,36],[91,71,179,6],[92,0,180,5],[92,7,175,4],[92,13,180,11],[93,0,181,6,"_nextUpdateHandle"],[93,8,181,6,"_nextUpdateHandle"],[93,25,181,23],[93,28,181,26,"setImmediate"],[93,40,181,38],[93,41,181,39,"_processUpdate"],[93,55,181,38],[93,56,181,6],[94,0,182,5],[95,0,183,3],[96,0,184,1],[98,0,189,0],[98,11,189,9,"_processUpdate"],[98,25,189,0],[98,28,189,26],[99,0,190,2,"_nextUpdateHandle"],[99,4,190,2,"_nextUpdateHandle"],[99,21,190,19],[99,24,190,22],[99,25,190,2],[100,0,192,2],[100,8,192,8,"interactionCount"],[100,24,192,24],[100,27,192,27,"_interactionSet"],[100,42,192,42],[100,43,192,43,"size"],[100,47,192,2],[102,0,193,2,"_addInteractionSet"],[102,4,193,2,"_addInteractionSet"],[102,22,193,20],[102,23,193,21,"forEach"],[102,30,193,2],[102,31,193,29],[102,41,193,29,"handle"],[102,47,193,35],[103,0,193,35],[103,13,193,39,"_interactionSet"],[103,28,193,54],[103,29,193,55,"add"],[103,32,193,39],[103,33,193,59,"handle"],[103,39,193,39],[103,40,193,35],[104,0,193,35],[104,5,193,2],[106,0,194,2,"_deleteInteractionSet"],[106,4,194,2,"_deleteInteractionSet"],[106,25,194,23],[106,26,194,24,"forEach"],[106,33,194,2],[106,34,194,32],[106,44,194,32,"handle"],[106,50,194,38],[107,0,194,38],[107,13,194,42,"_interactionSet"],[107,28,194,57],[107,29,194,58,"delete"],[107,35,194,42],[107,36,194,65,"handle"],[107,42,194,42],[107,43,194,38],[108,0,194,38],[108,5,194,2],[110,0,195,2],[110,8,195,8,"nextInteractionCount"],[110,28,195,28],[110,31,195,31,"_interactionSet"],[110,46,195,46],[110,47,195,47,"size"],[110,51,195,2],[112,0,197,2],[112,8,197,6,"interactionCount"],[112,24,197,22],[112,29,197,27],[112,30,197,6],[112,34,197,32,"nextInteractionCount"],[112,54,197,52],[112,59,197,57],[112,60,197,2],[112,62,197,60],[113,0,199,4,"_emitter"],[113,6,199,4,"_emitter"],[113,14,199,12],[113,15,199,13,"emit"],[113,19,199,4],[113,20,199,18,"InteractionManager"],[113,38,199,36],[113,39,199,37,"Events"],[113,45,199,18],[113,46,199,44,"interactionComplete"],[113,65,199,4],[114,0,200,3],[114,5,197,2],[114,11,200,9],[114,15,200,13,"interactionCount"],[114,31,200,29],[114,36,200,34],[114,37,200,13],[114,41,200,39,"nextInteractionCount"],[114,61,200,59],[114,66,200,64],[114,67,200,9],[114,69,200,67],[115,0,202,4,"_emitter"],[115,6,202,4,"_emitter"],[115,14,202,12],[115,15,202,13,"emit"],[115,19,202,4],[115,20,202,18,"InteractionManager"],[115,38,202,36],[115,39,202,37,"Events"],[115,45,202,18],[115,46,202,44,"interactionStart"],[115,62,202,4],[116,0,203,3],[118,0,206,2],[118,8,206,6,"nextInteractionCount"],[118,28,206,26],[118,33,206,31],[118,34,206,2],[118,36,206,34],[119,0,207,4],[119,13,207,11,"_taskQueue"],[119,23,207,21],[119,24,207,22,"hasTasksToProcess"],[119,41,207,11],[119,43,207,4],[119,45,207,43],[120,0,208,6,"_taskQueue"],[120,8,208,6,"_taskQueue"],[120,18,208,16],[120,19,208,17,"processNext"],[120,30,208,6],[122,0,209,6],[122,12,210,8,"_deadline"],[122,21,210,17],[122,24,210,20],[122,25,210,8],[122,29,211,8],[122,94,211,22,"getEventLoopRunningTime"],[122,117,211,8],[122,123,211,51,"_deadline"],[122,132,209,6],[122,134,212,8],[123,0,214,8,"_scheduleUpdate"],[123,10,214,8,"_scheduleUpdate"],[123,25,214,23],[125,0,215,8],[126,0,216,7],[127,0,217,5],[128,0,218,3],[130,0,219,2,"_addInteractionSet"],[130,4,219,2,"_addInteractionSet"],[130,22,219,20],[130,23,219,21,"clear"],[130,28,219,2],[132,0,220,2,"_deleteInteractionSet"],[132,4,220,2,"_deleteInteractionSet"],[132,25,220,23],[132,26,220,24,"clear"],[132,31,220,2],[133,0,221,1],[135,0,223,0,"module"],[135,2,223,0,"module"],[135,8,223,6],[135,9,223,7,"exports"],[135,16,223,0],[135,19,223,17,"InteractionManager"],[135,37,223,0]],"functionMap":{"names":["<global>","runAfterInteractions","Promise$argument_0","done","cancel","createInteractionHandle","clearInteractionHandle","setDeadline","_scheduleUpdate","_processUpdate","_addInteractionSet.forEach$argument_0","_deleteInteractionSet.forEach$argument_0"],"mappings":"AAA;ECuF;gCCY;KDU;YEG;OFQ;cGC;OHE;GDE;EKK;GLM;EMK;GNM;EOS;GPE;AQc;CRW;ASK;6BCI,qCD;gCEC,wCF;CT2B"}},"type":"js/module"}]}