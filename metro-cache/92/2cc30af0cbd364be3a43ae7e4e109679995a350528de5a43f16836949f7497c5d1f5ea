{"dependencies":[{"name":"./batch","data":{"asyncType":null,"locs":[{"start":{"line":12,"column":18},"end":{"line":12,"column":33}}]}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  exports.__esModule = true;\n  exports.createSubscription = createSubscription;\n\n  function createListenerCollection() {\n    var batch = (0, _$$_REQUIRE(_dependencyMap[0], \"./batch\").getBatch)();\n    var first = null;\n    var last = null;\n    return {\n      clear: function clear() {\n        first = null;\n        last = null;\n      },\n      notify: function notify() {\n        batch(function () {\n          var listener = first;\n\n          while (listener) {\n            listener.callback();\n            listener = listener.next;\n          }\n        });\n      },\n      get: function get() {\n        var listeners = [];\n        var listener = first;\n\n        while (listener) {\n          listeners.push(listener);\n          listener = listener.next;\n        }\n\n        return listeners;\n      },\n      subscribe: function subscribe(callback) {\n        var isSubscribed = true;\n        var listener = last = {\n          callback: callback,\n          next: null,\n          prev: last\n        };\n\n        if (listener.prev) {\n          listener.prev.next = listener;\n        } else {\n          first = listener;\n        }\n\n        return function unsubscribe() {\n          if (!isSubscribed || first === null) return;\n          isSubscribed = false;\n\n          if (listener.next) {\n            listener.next.prev = listener.prev;\n          } else {\n            last = listener.prev;\n          }\n\n          if (listener.prev) {\n            listener.prev.next = listener.next;\n          } else {\n            first = listener.next;\n          }\n        };\n      }\n    };\n  }\n\n  var nullListeners = {\n    notify: function notify() {},\n    get: function get() {\n      return [];\n    }\n  };\n\n  function createSubscription(store, parentSub) {\n    var unsubscribe;\n    var listeners = nullListeners;\n\n    function addNestedSub(listener) {\n      trySubscribe();\n      return listeners.subscribe(listener);\n    }\n\n    function notifyNestedSubs() {\n      listeners.notify();\n    }\n\n    function handleChangeWrapper() {\n      if (subscription.onStateChange) {\n        subscription.onStateChange();\n      }\n    }\n\n    function isSubscribed() {\n      return Boolean(unsubscribe);\n    }\n\n    function trySubscribe() {\n      if (!unsubscribe) {\n        unsubscribe = parentSub ? parentSub.addNestedSub(handleChangeWrapper) : store.subscribe(handleChangeWrapper);\n        listeners = createListenerCollection();\n      }\n    }\n\n    function tryUnsubscribe() {\n      if (unsubscribe) {\n        unsubscribe();\n        unsubscribe = undefined;\n        listeners.clear();\n        listeners = nullListeners;\n      }\n    }\n\n    var subscription = {\n      addNestedSub: addNestedSub,\n      notifyNestedSubs: notifyNestedSubs,\n      handleChangeWrapper: handleChangeWrapper,\n      isSubscribed: isSubscribed,\n      trySubscribe: trySubscribe,\n      tryUnsubscribe: tryUnsubscribe,\n      getListeners: function getListeners() {\n        return listeners;\n      }\n    };\n    return subscription;\n  }\n});","lineCount":130,"map":[[2,0,1,0],[4,0,3,0,"exports"],[4,2,3,0,"exports"],[4,9,3,7],[4,10,3,8,"__esModule"],[4,20,3,0],[4,23,3,21],[4,27,3,0],[5,0,4,0,"exports"],[5,2,4,0,"exports"],[5,9,4,7],[5,10,4,8,"createSubscription"],[5,28,4,0],[5,31,4,29,"createSubscription"],[5,49,4,0],[7,0,11,0],[7,11,11,9,"createListenerCollection"],[7,35,11,0],[7,38,11,36],[8,0,12,2],[8,8,12,6,"batch"],[8,13,12,11],[8,16,12,14],[8,17,12,15],[8,20,12,18],[8,62,12,25,"getBatch"],[8,70,12,14],[8,73,12,2],[9,0,13,2],[9,8,13,6,"first"],[9,13,13,11],[9,16,13,14],[9,20,13,2],[10,0,14,2],[10,8,14,6,"last"],[10,12,14,10],[10,15,14,13],[10,19,14,2],[11,0,15,2],[11,11,15,9],[12,0,16,4,"clear"],[12,6,16,4,"clear"],[12,11,16,9],[12,13,16,11],[12,22,16,20,"clear"],[12,27,16,11],[12,30,16,28],[13,0,17,6,"first"],[13,8,17,6,"first"],[13,13,17,11],[13,16,17,14],[13,20,17,6],[14,0,18,6,"last"],[14,8,18,6,"last"],[14,12,18,10],[14,15,18,13],[14,19,18,6],[15,0,19,5],[15,7,15,9],[16,0,20,4,"notify"],[16,6,20,4,"notify"],[16,12,20,10],[16,14,20,12],[16,23,20,21,"notify"],[16,29,20,12],[16,32,20,30],[17,0,21,6,"batch"],[17,8,21,6,"batch"],[17,13,21,11],[17,14,21,12],[17,26,21,24],[18,0,22,8],[18,14,22,12,"listener"],[18,22,22,20],[18,25,22,23,"first"],[18,30,22,8],[20,0,24,8],[20,17,24,15,"listener"],[20,25,24,8],[20,27,24,25],[21,0,25,10,"listener"],[21,12,25,10,"listener"],[21,20,25,18],[21,21,25,19,"callback"],[21,29,25,10],[22,0,26,10,"listener"],[22,12,26,10,"listener"],[22,20,26,18],[22,23,26,21,"listener"],[22,31,26,29],[22,32,26,30,"next"],[22,36,26,10],[23,0,27,9],[24,0,28,7],[24,9,21,11],[24,10,21,6],[25,0,29,5],[25,7,15,9],[26,0,30,4,"get"],[26,6,30,4,"get"],[26,9,30,7],[26,11,30,9],[26,20,30,18,"get"],[26,23,30,9],[26,26,30,24],[27,0,31,6],[27,12,31,10,"listeners"],[27,21,31,19],[27,24,31,22],[27,26,31,6],[28,0,32,6],[28,12,32,10,"listener"],[28,20,32,18],[28,23,32,21,"first"],[28,28,32,6],[30,0,34,6],[30,15,34,13,"listener"],[30,23,34,6],[30,25,34,23],[31,0,35,8,"listeners"],[31,10,35,8,"listeners"],[31,19,35,17],[31,20,35,18,"push"],[31,24,35,8],[31,25,35,23,"listener"],[31,33,35,8],[32,0,36,8,"listener"],[32,10,36,8,"listener"],[32,18,36,16],[32,21,36,19,"listener"],[32,29,36,27],[32,30,36,28,"next"],[32,34,36,8],[33,0,37,7],[35,0,39,6],[35,15,39,13,"listeners"],[35,24,39,6],[36,0,40,5],[36,7,15,9],[37,0,41,4,"subscribe"],[37,6,41,4,"subscribe"],[37,15,41,13],[37,17,41,15],[37,26,41,24,"subscribe"],[37,35,41,15],[37,36,41,34,"callback"],[37,44,41,15],[37,46,41,44],[38,0,42,6],[38,12,42,10,"isSubscribed"],[38,24,42,22],[38,27,42,25],[38,31,42,6],[39,0,43,6],[39,12,43,10,"listener"],[39,20,43,18],[39,23,43,21,"last"],[39,27,43,25],[39,30,43,28],[40,0,44,8,"callback"],[40,10,44,8,"callback"],[40,18,44,16],[40,20,44,18,"callback"],[40,28,43,28],[41,0,45,8,"next"],[41,10,45,8,"next"],[41,14,45,12],[41,16,45,14],[41,20,43,28],[42,0,46,8,"prev"],[42,10,46,8,"prev"],[42,14,46,12],[42,16,46,14,"last"],[43,0,43,28],[43,9,43,6],[45,0,49,6],[45,12,49,10,"listener"],[45,20,49,18],[45,21,49,19,"prev"],[45,25,49,6],[45,27,49,25],[46,0,50,8,"listener"],[46,10,50,8,"listener"],[46,18,50,16],[46,19,50,17,"prev"],[46,23,50,8],[46,24,50,22,"next"],[46,28,50,8],[46,31,50,29,"listener"],[46,39,50,8],[47,0,51,7],[47,9,49,6],[47,15,51,13],[48,0,52,8,"first"],[48,10,52,8,"first"],[48,15,52,13],[48,18,52,16,"listener"],[48,26,52,8],[49,0,53,7],[51,0,55,6],[51,15,55,13],[51,24,55,22,"unsubscribe"],[51,35,55,13],[51,38,55,36],[52,0,56,8],[52,14,56,12],[52,15,56,13,"isSubscribed"],[52,27,56,12],[52,31,56,29,"first"],[52,36,56,34],[52,41,56,39],[52,45,56,8],[52,47,56,45],[53,0,57,8,"isSubscribed"],[53,10,57,8,"isSubscribed"],[53,22,57,20],[53,25,57,23],[53,30,57,8],[55,0,59,8],[55,14,59,12,"listener"],[55,22,59,20],[55,23,59,21,"next"],[55,27,59,8],[55,29,59,27],[56,0,60,10,"listener"],[56,12,60,10,"listener"],[56,20,60,18],[56,21,60,19,"next"],[56,25,60,10],[56,26,60,24,"prev"],[56,30,60,10],[56,33,60,31,"listener"],[56,41,60,39],[56,42,60,40,"prev"],[56,46,60,10],[57,0,61,9],[57,11,59,8],[57,17,61,15],[58,0,62,10,"last"],[58,12,62,10,"last"],[58,16,62,14],[58,19,62,17,"listener"],[58,27,62,25],[58,28,62,26,"prev"],[58,32,62,10],[59,0,63,9],[61,0,65,8],[61,14,65,12,"listener"],[61,22,65,20],[61,23,65,21,"prev"],[61,27,65,8],[61,29,65,27],[62,0,66,10,"listener"],[62,12,66,10,"listener"],[62,20,66,18],[62,21,66,19,"prev"],[62,25,66,10],[62,26,66,24,"next"],[62,30,66,10],[62,33,66,31,"listener"],[62,41,66,39],[62,42,66,40,"next"],[62,46,66,10],[63,0,67,9],[63,11,65,8],[63,17,67,15],[64,0,68,10,"first"],[64,12,68,10,"first"],[64,17,68,15],[64,20,68,18,"listener"],[64,28,68,26],[64,29,68,27,"next"],[64,33,68,10],[65,0,69,9],[66,0,70,7],[66,9,55,6],[67,0,71,5],[68,0,15,9],[68,5,15,2],[69,0,73,1],[71,0,75,0],[71,6,75,4,"nullListeners"],[71,19,75,17],[71,22,75,20],[72,0,76,2,"notify"],[72,4,76,2,"notify"],[72,10,76,8],[72,12,76,10],[72,21,76,19,"notify"],[72,27,76,10],[72,30,76,28],[72,31,76,30],[72,32,75,20],[73,0,77,2,"get"],[73,4,77,2,"get"],[73,7,77,5],[73,9,77,7],[73,18,77,16,"get"],[73,21,77,7],[73,24,77,22],[74,0,78,4],[74,13,78,11],[74,15,78,4],[75,0,79,3],[76,0,75,20],[76,3,75,0],[78,0,82,0],[78,11,82,9,"createSubscription"],[78,29,82,0],[78,30,82,28,"store"],[78,35,82,0],[78,37,82,35,"parentSub"],[78,46,82,0],[78,48,82,46],[79,0,83,2],[79,8,83,6,"unsubscribe"],[79,19,83,2],[80,0,84,2],[80,8,84,6,"listeners"],[80,17,84,15],[80,20,84,18,"nullListeners"],[80,33,84,2],[82,0,86,2],[82,13,86,11,"addNestedSub"],[82,25,86,2],[82,26,86,24,"listener"],[82,34,86,2],[82,36,86,34],[83,0,87,4,"trySubscribe"],[83,6,87,4,"trySubscribe"],[83,18,87,16],[84,0,88,4],[84,13,88,11,"listeners"],[84,22,88,20],[84,23,88,21,"subscribe"],[84,32,88,11],[84,33,88,31,"listener"],[84,41,88,11],[84,42,88,4],[85,0,89,3],[87,0,91,2],[87,13,91,11,"notifyNestedSubs"],[87,29,91,2],[87,32,91,30],[88,0,92,4,"listeners"],[88,6,92,4,"listeners"],[88,15,92,13],[88,16,92,14,"notify"],[88,22,92,4],[89,0,93,3],[91,0,95,2],[91,13,95,11,"handleChangeWrapper"],[91,32,95,2],[91,35,95,33],[92,0,96,4],[92,10,96,8,"subscription"],[92,22,96,20],[92,23,96,21,"onStateChange"],[92,36,96,4],[92,38,96,36],[93,0,97,6,"subscription"],[93,8,97,6,"subscription"],[93,20,97,18],[93,21,97,19,"onStateChange"],[93,34,97,6],[94,0,98,5],[95,0,99,3],[97,0,101,2],[97,13,101,11,"isSubscribed"],[97,25,101,2],[97,28,101,26],[98,0,102,4],[98,13,102,11,"Boolean"],[98,20,102,18],[98,21,102,19,"unsubscribe"],[98,32,102,18],[98,33,102,4],[99,0,103,3],[101,0,105,2],[101,13,105,11,"trySubscribe"],[101,25,105,2],[101,28,105,26],[102,0,106,4],[102,10,106,8],[102,11,106,9,"unsubscribe"],[102,22,106,4],[102,24,106,22],[103,0,107,6,"unsubscribe"],[103,8,107,6,"unsubscribe"],[103,19,107,17],[103,22,107,20,"parentSub"],[103,31,107,29],[103,34,107,32,"parentSub"],[103,43,107,41],[103,44,107,42,"addNestedSub"],[103,56,107,32],[103,57,107,55,"handleChangeWrapper"],[103,76,107,32],[103,77,107,29],[103,80,107,78,"store"],[103,85,107,83],[103,86,107,84,"subscribe"],[103,95,107,78],[103,96,107,94,"handleChangeWrapper"],[103,115,107,78],[103,116,107,6],[104,0,108,6,"listeners"],[104,8,108,6,"listeners"],[104,17,108,15],[104,20,108,18,"createListenerCollection"],[104,44,108,42],[104,46,108,6],[105,0,109,5],[106,0,110,3],[108,0,112,2],[108,13,112,11,"tryUnsubscribe"],[108,27,112,2],[108,30,112,28],[109,0,113,4],[109,10,113,8,"unsubscribe"],[109,21,113,4],[109,23,113,21],[110,0,114,6,"unsubscribe"],[110,8,114,6,"unsubscribe"],[110,19,114,17],[111,0,115,6,"unsubscribe"],[111,8,115,6,"unsubscribe"],[111,19,115,17],[111,22,115,20,"undefined"],[111,31,115,6],[112,0,116,6,"listeners"],[112,8,116,6,"listeners"],[112,17,116,15],[112,18,116,16,"clear"],[112,23,116,6],[113,0,117,6,"listeners"],[113,8,117,6,"listeners"],[113,17,117,15],[113,20,117,18,"nullListeners"],[113,33,117,6],[114,0,118,5],[115,0,119,3],[117,0,121,2],[117,8,121,6,"subscription"],[117,20,121,18],[117,23,121,21],[118,0,122,4,"addNestedSub"],[118,6,122,4,"addNestedSub"],[118,18,122,16],[118,20,122,18,"addNestedSub"],[118,32,121,21],[119,0,123,4,"notifyNestedSubs"],[119,6,123,4,"notifyNestedSubs"],[119,22,123,20],[119,24,123,22,"notifyNestedSubs"],[119,40,121,21],[120,0,124,4,"handleChangeWrapper"],[120,6,124,4,"handleChangeWrapper"],[120,25,124,23],[120,27,124,25,"handleChangeWrapper"],[120,46,121,21],[121,0,125,4,"isSubscribed"],[121,6,125,4,"isSubscribed"],[121,18,125,16],[121,20,125,18,"isSubscribed"],[121,32,121,21],[122,0,126,4,"trySubscribe"],[122,6,126,4,"trySubscribe"],[122,18,126,16],[122,20,126,18,"trySubscribe"],[122,32,121,21],[123,0,127,4,"tryUnsubscribe"],[123,6,127,4,"tryUnsubscribe"],[123,20,127,18],[123,22,127,20,"tryUnsubscribe"],[123,36,121,21],[124,0,128,4,"getListeners"],[124,6,128,4,"getListeners"],[124,18,128,16],[124,20,128,18],[124,29,128,27,"getListeners"],[124,41,128,18],[124,44,128,42],[125,0,129,6],[125,15,129,13,"listeners"],[125,24,129,6],[126,0,130,5],[127,0,121,21],[127,5,121,2],[128,0,132,2],[128,11,132,9,"subscription"],[128,23,132,2],[129,0,133,1]],"functionMap":{"names":["<global>","createListenerCollection","clear","notify","batch$argument_0","get","subscribe","unsubscribe","createSubscription","addNestedSub","notifyNestedSubs","handleChangeWrapper","isSubscribed","trySubscribe","tryUnsubscribe","getListeners"],"mappings":"AAA;ACU;WCK;KDG;YEC;YCC;ODO;KFC;SIC;KJU;eKC;aCc;ODe;KLC;CDE;UGG,oBH;OKC;GLE;AQG;ECI;GDG;EEE;GFE;EGE;GHI;EIE;GJE;EKE;GLK;EME;GNO;kBOS;KPE"}},"type":"js/module"}]}